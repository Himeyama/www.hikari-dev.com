---
title: 基本情報データベースまとめ
layout: post
toc: true
---

## 関係モデル
### 関係モデルと関係データベースの対応

|関係モデル|関係データベース|
|:--:|:--:|
|関係|表|
|属性|列|
|タプル|行|
|定義域|データ型。属性がとりえる値の集合。|

- 属性に順序はない
- 属性名は関係内で一意
- 属性名には必ず名前を付ける

(基本情報技術者試験平成 28 年春期午前問 26)  
(基本情報技術者試験平成 31 年春期午前問 26)

## 関係データベース, リレーショナルデータベース (RDB, Relational DataBase)
関係データベースは、**データを 2 次元の表によって表現する。**

(基本情報技術者試験平成 23 年秋期午前問 31)

## スキーマ
スキーマとは、**データの性質、形式、ほかのデータとの関連などデータ定義の集合である。**

(基本情報技術者試験平成 26 年秋期午前問 26)

### 3 層スキーマ
3 層スキーマには、
- 外部スキーマ: 利用者からみえるもの
- 概念スキーマ: 開発者からみえるもの
- 内部スキーマ: 物理的な構造

3 層スキーマの目的は、**データの物理的な格納構造を変更しても，アプリケーションプログラムに影響が及ばないようにする。**

(基本情報技術者試験平成 27 年春期午前問 26)

## データベース管理システム (DBMS, DataBase Management System)
データベースを管理するソフトウェア。

|機能|概要|
|:--:|:--:|
|保全機能|排他制御や参照制約、表制約によってデータの完全性を保つ機能|
|障害回復機能|ロールバック、ロールフォワード、チェックポイント、ログによってデータベース障害から回復する機能|
|機密保護機能|データの改ざんや漏洩を防ぐ機能|

(基本情報技術者試験平成 16 年春期午前問 70)

## E-R 図 (Entity-Relationship Diagram)
E-R 図は、**エンティティ間の関連**を示す。
エンティティとは実体のこと。

(基本情報技術者試験平成 18 年春期午前問 38)

## 表の設計
### 主キー (Primary Key)
表中の行を一意に識別するための列。

- 一意制約
- 非 (NOT) NULL 制約
- 先頭でなくても OK
- 複数の列と合わせて主キーとしても OK (複合キー)

(基本情報技術者試験平成 25 年秋期午前問 30)

### 外部キー (Foreign Key)
他の表の主キーを参照している列。

- 参照制約 (参照一貫性が維持される制約)

(基本情報技術者試験平成 28 年春期午前問 29)

**リレーション**とは、主キーと外部キーを用いた表間の関連付け。

## データの正規化
データベースを構築する際に、**データの重複や矛盾を排除**する。

(基本情報技術者試験平成 15 年春期午前問 67)  
(基本情報技術者試験平成 16 年秋期午前問 67)  
(基本情報技術者試験平成 18 年秋期午前問 61)  

### 第 1 正規化
- 繰り返しの項目をなくす
- 計算で求められる項目をなくす

### 第 2 正規化
主キーの一部で一意に決まるものを別表に移す

- 部分関数従属: 主キーの一部によって項目が一意に決定する関係
- 完全関数従属: 主キーによって項目が一意に決定する関係

### 第 3 正規化
主キー以外によって決まる項目を、別表に移す

- 推移的関数従属: 主キー以外の項目によって項目が一意に決定する関係

(基本情報技術者試験平成 20 年秋期午前問 57)

## トランザクション処理
一連の処理をひとまとめにしたもの。

### ACID 特性
トランザクションの性質

|特性|概要|
|:--:|:--:|
|**原子性 (Atomicity)**|トランザクションが完了したか、してないか|
|一貫性 (Consistency)|データベースの内容に矛盾がない。整合性がある|
|独立性 (Isolation)|同時に実行した場合と順番に実行した場合で結果が同じ|
|耐久性 (Durability)|トランザクション正常終了後、障害時にデータが消失しない|

(基本情報技術者試験平成 24 年秋期午前問 30)  
(基本情報技術者試験平成 26 年春期午前問 29)

## 排他制御
データベースの一貫性を保つためにほかのトランザクションからのアクセスを制限 (**ロック**)

排他制御の目的は、データの**整合性を保つ**こと

(基本情報技術者試験平成 24 年春期午前問 33)  
(基本情報技術者試験平成 28 年春期午前問 30)

### 共有ロック
トランザクションがデータを**参照**する前にかけるロック

### 専有ロック
トランザクションがデータを**更新**する前にかけるロック

**共有ロックした後に、他のトランザクションは共有ロックすることだけが可能**

### ロックの粒度
ロックの粒度を大きく (表単位など) すると、**他のトランザクションの待ちが多く**なり、**全体のスループット**が低下する。

(基本情報技術者試験平成 30 年秋期午前問 29)

表単位などロックの粒度が大きいとロックの競合が起こりやすく、
行単位などロックの粒度が小さいとメモリ使用領域が多く必要になる。

(基本情報技術者試験平成 30 年春期午前問 30)

## デッドロック
複数のトランザクションが、**互いに相手の専有ロックしている資源を要求して待ち状態**となり、実行できなくなること。

(基本情報技術者試験平成 16 年春期午前問 69)

デッドロックが発生した場合は、**片方**のトランザクションをロールバックする。

(基本情報技術者試験平成 18 年春期午前問 59)

## 2 相コミットメント
一連のトランザクション処理を行う複数サイトに更新処理が確定可能かどうかを問い合わせ、すべてのサイトが確定可能である場合、更新処理を確定する方式。

(基本情報技術者試験平成 17 年春期午前問 63)
(基本情報技術者試験平成 29 年春期午前問 28)

トランザクションの途中で障害が発生した場合はロールバックする

## データベースの障害回復
### ロールフォワード
フルバックアップファイルと**更新後ログ**を用いて復旧する

### ロールバック
**更新前ログ**を用いて復旧する

### チェックポイント
**データベース更新バッファの内容をデータベースに書出す。**

## 関係演算
- 射影: 列を取出す
- 選択: 行を取出す
- 結合: 複数の表から一つの表を生成
- 和: 二つの表の行を取出す。同じ行はまとめる。
- 積: 共通の行を取出す
- 差: 一つの表からもう片方の表の行を除いたものを取出す

## SQL
### DDL, Data Definition Language (データ定義言語)
#### CREATE TABLE
テーブルを作成する。
概念スキーマに相当。実表。

```sql
CREATE TABLE TableName(ColumnName1 Type1, ...)
```

#### CREATE VIEW
ビューを定義する。
外部スキーマに相当。仮想表。

### DML, Data Manipulation Language (データ操作言語)

#### SELECT
クエリ (問合せ) を行う。

```sql
SELECT Column, ... FROM Table, ... WHERE Conditions
```

- 射影

  列を取り出す操作

  > `Col` を取り出す場合

  ```sql
  SELECT Col FROM Table
  ```

- 選択

  行を取り出す操作

  > `Price` が 100 または 120 である行を取り出す場合

  ```sql
  SELECT * FROM Table WHERE Price=100 OR Price=120
  ```

  ```sql
  SELECT * FROM Table WHERE Price IN (100, 120)
  ```

  > `Price` が 100 以上 200 以下である行を取り出す場合

  ```sql
  SELECT * FROM Table WHERE Price >= 100 AND Price <= 200
  ```

  ```sql
  SELECT * FROM Table WHERE BETWEEN 100 AND 200
  ```

  > `Name` が "田" で終わる行を取り出す場合
  ```sql
  SELECT * FROM Table WHERE Name LIKE "%田"
  ```

  - %: 0 文字以上にマッチ
  - _: 1 文字以上にマッチ

### 結合
- DISTINCT: 重複した行を一つにまとめる

### 並び替え (ORDER BY)
#### 昇順 (ASC)
```sql
SELECT ... FROM ... ORDER BY ColumnName ASC
```

`ASC` は省略可。

#### 降順 (DESC)
```sql
SELECT ... FROM ... ORDER BY ColumnName DESC
```

### 集合関数

|関数|意味|
|:--:|:--:|
|AVG|平均|
|COUNT|行数|
|MIN|最小値|
|MAX|最大値|
|SUM|合計|

### グループ化 (GROUP BY)
```sql
SELECT ... FROM ... GROUP BY ColumnName
```

### 別名 (AS)
```sql
SUM(ColumnName) AS GOUKEI
```

### グループの条件 (HAVING)
```sql
GROUP BY ColumnName HAVING ...
```

### 含まれる行を抽出 (IN)
```sql
... WHERE IN (SELECT ...)
```

含まれない行の場合は `NOT IN`

### 相関副問合せ (EXISTS)
存在する場合は真

```sql
... WHERE EXISTS (SELECT ...)
```

## データベースの活用
### データウェアハウス
企業の様々な活動を介して得られた大量のデータを整理・統合して**蓄積**しておき，意思決定支援などに利用するもの。

(基本情報技術者試験平成 22 年春期午前問 33)

### データマイニング
企業が保有する顧客や市場などの膨大なデータから，有用な情報や関係を**見つけ出す**手法

(基本情報技術者試験平成 19 年秋期午前問 38)  
(基本情報技術者試験平成 24 年春期午前問 64)  
(基本情報技術者試験平成 29 年春期午前問 29)

### ビッグデータ
- SNS、動画、画像、音声などの**多種多様**なデータ
- 膨大なデータ容量
- リアルタイムで収集されるデータ

(基本情報技術者試験平成 29 年春期午前問 63)  

### オープンデータ
原則無償で自由に二次利用可能な官民データ

