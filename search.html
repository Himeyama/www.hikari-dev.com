---
layout: default
title: アーカイブ
---

<script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.js"></script>

<div style="display: grid; grid-template-columns: 1fr auto;">
    <input id="search-text" class="TextBox" placeholder="検索..." style="margin-right: 8px;" />
    <button class="button style-accent" id="search-button">検索</button>
</div>

<div id="search-result" style="margin-top: 8px"></div>


<script>
let posts_data = [
    {% for post in site.posts %}
    {
        "url": "{{ post.url | relative_url }}",
        "title": "{{ post.title }}",
        "date": "{{ post.date | date: "%Y-%m-%d" }}"
    },
    {% endfor %}
];

const options = {
  includeScore: true,
  keys: ['url', 'title']
};

const search_button = document.getElementById("search-button");
search_button.addEventListener('click', () => {
    search();
});

const search_text = document.getElementById("search-text");
search_text.addEventListener("keydown", () => {
    search();
});

const search = () => {
    const search_result = document.getElementById("search-result");
    search_result.innerHTML = "";

    const search_text = document.getElementById("search-text");
    const fuse = new Fuse(posts_data, options);
    const result = fuse.search(search_text.value);

    for(const page_info of result){
        const url_link_tag = document.createElement("a");
        url_link_tag.className = "post-link";
        const archive_post = document.createElement("div");
        archive_post.className = "archive-post";
        url_link_tag.appendChild(archive_post);
        const post_time = document.createElement("time");
        post_time.className = "post-date";
        const post_link_area = document.createElement("div");
        post_link_area.className = "post_link_area";
        archive_post.appendChild(post_time);
        archive_post.appendChild(post_link_area);
        
        url_link_tag.href = page_info.item.url;
        post_link_area.innerText = page_info.item.title;

        const date = page_info.item.date;
        const warekiDate = Wareki.date(date)
        post_time.innerText = Wareki.date(date);
        search_result.appendChild(url_link_tag);
    }
}
</script>

<script>
    postedDates = document.getElementsByClassName("post-date");
    for (let i = 0; i < postedDates.length; i++) {
        let date = postedDates[i].innerText
        if (date != "") {
            console.log(date)
            let warekiDate = Wareki.date(date)
            let DateYMandD = warekiDate.match(/(.*?月)(.*?日)/);
            let DateYM = DateYMandD[1];
            let DateD = DateYMandD[2];
            let ymd = date.split("-");
            postedDates[i].innerHTML = `<span class="archive-date"><a href="/${ymd[0]}/${ymd[1]}">${DateYM}</a>${DateD}</span>`;
        }
    }
</script>

